import{r as U,b as c,j as t,i as y,s as P,R as V,c as W,k as H,l as N,n as L,o as G,h as j,d as $,q,g as R,t as F,v as J,w as b,x as K,u as Q,C as X,y as Y,B as Z,z as ee,A as te}from"./index.31d0d1dc.js";import{r as ne}from"./logs.975cc896.js";import{S as w}from"./Select.f2dd4970.js";function ae(e,s){if(e==null)return{};var r=oe(e,s),l,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)l=o[a],!(s.indexOf(l)>=0)&&(!Object.prototype.propertyIsEnumerable.call(e,l)||(r[l]=e[l]))}return r}function oe(e,s){if(e==null)return{};var r={},l=Object.keys(e),a,o;for(o=0;o<l.length;o++)a=l[o],!(s.indexOf(a)>=0)&&(r[a]=e[a]);return r}var S=U.exports.forwardRef(function(e,s){var r=e.color,l=r===void 0?"currentColor":r,a=e.size,o=a===void 0?24:a,u=ae(e,["color","size"]);return c("svg",{ref:s,xmlns:"http://www.w3.org/2000/svg",width:o,height:o,viewBox:"0 0 24 24",fill:"none",stroke:l,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...u,children:[t("path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"}),t("polyline",{points:"16 17 21 12 16 7"}),t("line",{x1:"21",y1:"12",x2:"9",y2:"12"})]})});S.propTypes={color:y.exports.string,size:y.exports.oneOfType([y.exports.string,y.exports.number])};S.displayName="LogOut";const se=S,{useState:le,useRef:re,useEffect:ce,useCallback:ie}=V;function de(e){return t("input",{className:P.input,...e})}function ue({value:e,...s}){const[r,l]=le(e),a=re(e);ce(()=>{a.current!==e&&l(e),a.current=e},[e]);const o=ie(u=>l(u.target.value),[l]);return t("input",{className:P.input,value:r,onChange:o,...s})}const pe="_root_1tdl3_1",he="_section_1tdl3_2",ge="_wrapSwitch_1tdl3_26",fe="_sep_1tdl3_32",me="_label_1tdl3_45",d={root:pe,section:he,wrapSwitch:ge,sep:fe,label:me},ve="_fieldset_1ghjp_1",ye="_input_1ghjp_9",Ce="_cnt_1ghjp_9",k={fieldset:ve,input:ye,cnt:Ce};function be({OptionComponent:e,optionPropsList:s,selectedIndex:r,onChange:l}){const a=W("visually-hidden",k.input),o=u=>{l(u.target.value)};return t("fieldset",{className:k.fieldset,children:s.map((u,h)=>c("label",{children:[t("input",{type:"radio",checked:r===h,name:"selection",value:h,"aria-labelledby":"traffic chart type "+h,onChange:o,className:a}),t("div",{className:k.cnt,children:t(e,{...u})})]},h))})}const{useMemo:we}=j,ke={plugins:{legend:{display:!1}},scales:{x:{display:!1,type:"category"},y:{display:!1,type:"linear"}}},T=[23e3,35e3,46e3,33e3,9e4,68e3,23e3,45e3],Se=[184e3,183e3,196e3,182e3,19e4,186e3,182e3,189e3],_e=T;function xe({id:e}){const s=H.read(),r=we(()=>({labels:_e,datasets:[{...N,...L[e].up,data:T},{...N,...L[e].down,data:Se}]}),[e]),l="chart-"+e;return G(s.Chart,l,r,null,ke),t("div",{style:{width:100,padding:5},children:t("canvas",{id:l})})}const{useEffect:M,useState:Oe,useCallback:g,useRef:Ie,useMemo:Ne}=j,Le=[{id:0},{id:1},{id:2},{id:3}],Pe=[["debug","Debug"],["info","Info"],["warning","Warning"],["error","Error"],["silent","Silent"]],je=[{key:"port",label:"HTTP Proxy Port"},{key:"socks-port",label:"SOCKS5 Proxy Port"},{key:"mixed-port",label:"Mixed Port"},{key:"redir-port",label:"Redir Port"}],$e=[["zh","\u4E2D\u6587"],["en","English"]],Re=[["Global","Global"],["Rule","Rule"],["Direct","Direct"]],Te=e=>({configs:q(e),apiConfig:R(e)}),Me=e=>({selectedChartStyleIndex:ee(e),latencyTestUrl:te(e),apiConfig:R(e)}),ze=$(Me)(Ee),Ve=$(Te)(Ae);function Ae({dispatch:e,configs:s,apiConfig:r}){return M(()=>{e(F(r))},[e,r]),t(ze,{configs:s})}function Ee({dispatch:e,configs:s,selectedChartStyleIndex:r,latencyTestUrl:l,apiConfig:a}){const[o,u]=Oe(s),h=Ie(s);M(()=>{h.current!==s&&u(s),h.current=s},[s]);const z=g(()=>{e(J("apiConfig"))},[e]),f=g((n,i)=>{u({...o,[n]:i})},[o]),A=g(n=>{const i="allow-lan",p=n;f(i,p),e(b(a,{"allow-lan":p}))},[a,e,f]),m=g(({name:n,value:i})=>{switch(n){case"mode":case"log-level":f(n,i),e(b(a,{[n]:i})),n==="log-level"&&ne({...a,logLevel:i});break;case"redir-port":case"socks-port":case"mixed-port":case"port":if(i!==""){const p=parseInt(i,10);if(p<0||p>65535)return}f(n,i);break;default:return}},[a,e,f]),E=g(n=>m(n.target),[m]),{selectChartStyleIndex:B,updateAppConfig:_}=K(),x=g(n=>{const i=n.target,{name:p,value:I}=i;switch(p){case"port":case"socks-port":case"mixed-port":case"redir-port":{const C=parseInt(I,10);if(C<0||C>65535)return;e(b(a,{[p]:C}));break}case"latencyTestUrl":{_(p,I);break}default:throw new Error(`unknown input name ${p}`)}},[a,e,_]),D=Ne(()=>{const n=o.mode;return typeof n=="string"&&n[0].toUpperCase()+n.slice(1)},[o.mode]),{t:v,i18n:O}=Q();return c("div",{children:[t(X,{title:v("Config")}),c("div",{className:d.root,children:[je.map(n=>o[n.key]!==void 0?c("div",{children:[t("div",{className:d.label,children:n.label}),t(de,{name:n.key,value:o[n.key],onChange:E,onBlur:x})]},n.key):null),c("div",{children:[t("div",{className:d.label,children:"Mode"}),t(w,{options:Re,selected:D,onChange:n=>m({name:"mode",value:n.target.value})})]}),c("div",{children:[t("div",{className:d.label,children:"Log Level"}),t(w,{options:Pe,selected:o["log-level"],onChange:n=>m({name:"log-level",value:n.target.value})})]}),c("div",{children:[t("div",{className:d.label,children:"Allow LAN"}),t("div",{className:d.wrapSwitch,children:t(Y,{name:"allow-lan",checked:o["allow-lan"],onChange:A})})]})]}),t("div",{className:d.sep,children:t("div",{})}),c("div",{className:d.section,children:[c("div",{children:[t("div",{className:d.label,children:v("latency_test_url")}),t(ue,{name:"latencyTestUrl",type:"text",value:l,onBlur:x})]}),c("div",{children:[t("div",{className:d.label,children:v("lang")}),t("div",{children:t(w,{options:$e,selected:O.language,onChange:n=>O.changeLanguage(n.target.value)})})]}),c("div",{children:[t("div",{className:d.label,children:v("chart_style")}),t(be,{OptionComponent:xe,optionPropsList:Le,selectedIndex:r,onChange:B})]}),c("div",{children:[t("div",{className:d.label,children:"Action"}),t(Z,{start:t(se,{size:16}),label:"Switch backend",onClick:z})]})]})]})}export{Ve as default};
